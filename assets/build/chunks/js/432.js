"use strict";(globalThis.webpackChunkpoptics=globalThis.webpackChunkpoptics||[]).push([[432],{13225:(e,t,a)=>{a.d(t,{A:()=>i});var s=a(51609),n=a(38915),l=a(21863);const{__}=wp.i18n,i=()=>(0,s.createElement)("div",{className:"pt-filter-by"},(0,s.createElement)(l.ListFilterIcon,null),(0,s.createElement)(n.Text,{text:__("Filter By","poptics")}))},10309:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(51609),n=a(36400),l=a(39739),i=a(38915);const{__}=wp.i18n,r=(e,t,a)=>"prev"===t?(0,s.createElement)(i.Button,{"aria-label":__("previous button","poptics"),className:"pt-pagination-btn",text:__("Previous","poptics"),icon:(0,s.createElement)(n.A,null)}):"next"===t?(0,s.createElement)(i.Button,{"aria-label":__("next button","poptics"),className:"pt-pagination-btn",text:__("Next","poptics"),icon:(0,s.createElement)(l.A,null),iconPosition:"end"}):a},42759:(e,t,a)=>{a.d(t,{A:()=>r});var s=a(51609),n=a(86087),l=a(38915),i=a(21863);const{__}=wp.i18n,r=({searchFunc:e,placeholder:t})=>{const[a,r]=(0,n.useState)(!1),c=function(e,t){let a;return function(t){let s=this;clearTimeout(a),a=setTimeout((async()=>{r(!0),(await e.apply(s,[{search_key:t}])).complete&&r(!1)}),500)}}(e);return(0,s.createElement)(l.Input,{disabled:a,size:"large",className:"pt-search-input",placeholder:t||__("Search","poptics"),prefix:(0,s.createElement)(i.SearchIcon,{color:"#6B7280"}),onChange:e=>c(e.target.value)})}},16077:(e,t,a)=>{a.d(t,{A:()=>l});var s=a(51609),n=a(38915);const{__}=wp.i18n,l=e=>{const{total:t,paged:a,per_page:l}=e,i=(a-1)*l+1,r=Math.min(a*l,t);return(0,s.createElement)(n.Text,{className:"pt-campaign-count-text",text:__(`Showing ${i||""} to ${r||""} of ${t} entries`,"poptics")})}},66432:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var s=a(51609),n=a(38915),l=a(86087),i=a(46023),r=a(21437);const c=(0,l.createContext)(),{paged:o,per_page:p}=i.pagination,u=function(){const{setSubmissionsData:e}=(0,l.useContext)(c),{per_page:t,paged:a}=i.pagination;return{getAllSubmissionsByFiltering:async(s={})=>{const n={per_page:t,paged:a,...s};try{const t=await r.A.submissions.allSubmissions(n);e(t?.success?e=>({...e,submissionsList:t?.data?.items,total:t?.data?.status_count?.total,queryTotal:t?.data?.query_total,showing:t?.data?.items?.length,active:t?.data?.status_count?.active,trash:t?.data?.status_count?.trash}):e=>({...e,submissionsList:[]}))}catch(e){console.log("Data fetching error",e)}finally{return{complete:!0}}},deleteSubmission:async t=>{try{(await r.A.submissions.deleteSingleSubmission(t)).success&&e((e=>({...e,submissionsList:e.submissionsList.filter((e=>e.id!==t)),total:e.total-1})))}catch(e){console.log("Error",e)}},updateSubmission:async(t,a)=>{try{const s=await r.A.submissions.updateSubmissionStatus(t,a);s?.success&&e((e=>({...e,submissionsList:e.submissionsList.map((e=>e.id===t?{...e,status:a}:e)),active:parseInt(e.active)-1,trash:parseInt(e.trash)+1})))}catch(e){console.log(e)}},bulkDeleteSubmission:async(t=[])=>{try{(await r.A.submissions.bulkDeleteSubmission(t)).success&&e((e=>({...e,submissionsList:e.submissionsList.filter((e=>!t.includes(e.id))),total:e.total-t.length})))}catch(e){console.log("Error",e)}},getAllUserAgents:async()=>{try{let t=await r.A.submissions.allSubmissionAgents();t?.success&&e((e=>({...e,searchQuery:{...e.searchQuery,devices:t?.data?.devices,browsers:t?.data?.browsers,locations:t?.data?.locations}})))}catch(e){console.log(e)}}}};var m=a(92911),d=a(21863),g=a(9795),b=a(90070),E=a(47152),h=a(10309),v=a(16077),w=a(11387),y=a(71524),A=a(52741),x=a(16370),_=a(59499),S=a(55539),f=a(47953);const{__}=wp.i18n,k=e=>{const{isModalOpen:t,setIsModalOpen:a,submissionInfo:i}=e,r=Object.entries(i?.other_details||{})?.map((([e,t])=>{return{label:(a=e,a.split("_").join(" ")),value:t};var a})),c=[{label:__("Name","poptics"),value:i.other_details.name},{label:__("Email","poptics"),value:i.email},...r.filter((e=>"name"!==e.label))],o=[{label:__("Campaign Name","poptics"),value:i.campaign_name},{label:__("Location","poptics"),value:i.location},{label:__("Device","poptics"),value:i.device},{label:__("Browser","poptics"),value:i.browser}],p=({label:e,value:t})=>(0,s.createElement)(b.A,{size:"small",direction:"vertical"},(0,s.createElement)(n.Text,{className:"pt-submission-preview-item-label",strong:!0,text:e}),(0,s.createElement)(n.Text,{text:t||__("N/A","poptics")}));return(0,s.createElement)(l.Fragment,null,(0,s.createElement)(n.Modal,{className:"pt-submissions-preview-modal",title:__("Submission Details Preview","poptics"),footer:null,open:t,onOk:()=>{a(!1)},onCancel:()=>{a(!1)}},(0,s.createElement)(m.A,{vertical:!0},(0,s.createElement)(m.A,{gap:"middle",className:"pt-preview-modal-section"},(0,s.createElement)(n.Text,{text:__("Person Details","poptics"),className:"pt-preview-modal-section-title",strong:!0}),"trash"===i.status?(0,s.createElement)(y.A,{icon:(0,s.createElement)(_.A,null),color:"error"},__(" Trash","poptics")):(0,s.createElement)(y.A,{icon:(0,s.createElement)(S.A,null),color:"green"},__("Active","poptics"))),(0,s.createElement)(A.A,{orientationMargin:.005}),(0,s.createElement)(E.A,{justify:"space-between",gutter:[20,20]},c.map((e=>(0,s.createElement)(x.A,{sm:12},(0,s.createElement)(p,{label:e.label,value:e.value}))))),(0,s.createElement)(m.A,{className:"pt-preview-modal-section",gap:"middle"},(0,s.createElement)(n.Text,{text:__("Other Details","poptics"),className:"pt-preview-modal-section-title",strong:!0}),(0,s.createElement)(y.A,{icon:(0,s.createElement)(f.A,null),color:"processing"})),(0,s.createElement)(A.A,{orientationMargin:.005}),(0,s.createElement)(E.A,{justify:"space-between",gutter:[20,20]},o.map((e=>(0,s.createElement)(x.A,{sm:12},(0,s.createElement)(p,{label:e.label,value:e.value}))))))))},{__:N}=wp.i18n,C=({record:e})=>{const[t,a]=(0,l.useState)(!1),{updateSubmission:i,deleteSubmission:r}=u(),c=[{key:"preview",label:N("Preview","poptics"),icon:(0,s.createElement)(w.A,null),onClick:()=>{a(!0)}},{key:"trash",label:N("Trash","poptics"),icon:(0,s.createElement)(d.DeleteIcon,null),onClick:()=>i(e?.id,"trash")},{key:"delete",label:N("Delete","poptics"),icon:(0,s.createElement)(d.EmptyTrashIcon,null),onClick:()=>r(e?.id)}];return(0,s.createElement)(l.Fragment,null,(0,s.createElement)(m.A,{gap:"small",wrap:!0,justify:"end"},(0,s.createElement)(n.Dropdown,{menu:{items:c},placement:"left"},(0,s.createElement)(n.Button,{type:"text",text:(0,s.createElement)(d.MoreIcon,null)}))),(0,s.createElement)(k,{isModalOpen:t,setIsModalOpen:a,submissionInfo:e}))},{__:I}=wp.i18n,{__:T}=wp.i18n,B=()=>{const{submissionsList:e,searchQuery:t,queryTotal:a}=(0,l.useContext)(c),{per_page:r,paged:o}=t,[p,m]=(0,l.useState)([]),[d,w]=(0,l.useState)(!1),{getAllSubmissionsByFiltering:y,bulkDeleteSubmission:A}=u(),{modal:x}=g.A.useApp(),{columns:_}={columns:[{title:I("SN","poptics"),dataIndex:"id",key:"id",sorter:(e,t)=>e.id-t.id,width:30},{title:I("EMAIL","poptics"),dataIndex:"email",key:"email",width:120},{title:I("POPUP CAMPAIGN","poptics"),dataIndex:"campaign_name",key:"campaign_name",width:115},{title:I("LOCATION","poptics"),dataIndex:"location",key:"location",width:95},{title:I("DEVICE","poptics"),dataIndex:"device",key:"device",width:95},{title:I("BROWSER","poptics"),dataIndex:"browser",key:"browser",width:95},{title:"ACTIONS",key:"action",width:90,align:"right",render:(e,t)=>(0,s.createElement)(C,{record:t})}]},{pageSizeOptions:S}=i.pagination,f={selectedRowKeys:p,onChange:e=>{m(e)}};return(0,s.createElement)(l.Fragment,null,p.length>0?(0,s.createElement)(b.A,{className:"pt-bulk-delete"},(0,s.createElement)(n.Button,{danger:!0,onClick:()=>{x.confirm({title:T("Are you sure delete selected staffs?","poptics"),okText:T("Yes","poptics"),okType:"danger",cancelText:T("No","poptics"),onOk:()=>(async()=>{w(!0),await A(p),m([]),w(!1)})()})},text:T("Bulk Delete","poptics"),loading:d}),p.length,T("items selected","poptics")):null,(0,s.createElement)(n.Table,{rowSelection:{...f},columns:_,dataSource:e,rowKey:e=>e?.id,scroll:{y:"calc(100vh - 250px)",x:640},pagination:!1,className:"pt-campaign-table"}),(0,s.createElement)(E.A,{justify:"space-between",gutter:[0,15]},(0,s.createElement)(v.A,{per_page:r,paged:o,total:a}),(0,s.createElement)(n.Pagination,{defaultPageSize:r,showSizeChanger:!0,onChange:(e,t)=>{y({paged:e,per_page:t})},total:a,itemRender:h.A,pageSizeOptions:S})))},{__:D}=wp.i18n,{__:L}=wp.i18n,O=()=>{const[e,t]=(0,l.useState)(1),{getAllSubmissionsByFiltering:a}=u();return(0,s.createElement)(m.A,{className:"pt-entries-status-filter-container",gap:"middle"},(()=>{const{total:e,active:t,trash:a}=(0,l.useContext)(c);return[{label:D("All Entries","poptics"),value:e,index:1,filterKey:""},{label:D("Active","poptics"),value:t,filterKey:"active",index:2},{label:D("Trash","poptics"),value:a,filterKey:"trash",index:3}]})().map((l=>(0,s.createElement)(m.A,{onClick:()=>{return t((e=l).index),void a({status:e.filterKey});var e},key:l.index,className:"pt-entries-key-filters-container",gap:"small"},(0,s.createElement)(n.Text,{className:` ${l.index===e&&"pt-entries-key-filter-active"}`,text:l.label}),(0,s.createElement)(n.Text,{className:"pt-entries-key-filters-value",text:`${l.value}+`})))))};var F=a(13225);const{__:P}=wp.i18n,M=()=>{const{searchQuery:e}=(0,l.useContext)(c),{getAllSubmissionsByFiltering:t}=u(),[a,i]=(0,l.useState)({location:"",browser:"",device:""}),{browsers:r,devices:o,locations:p}=e,d=e=>{if(""===e)return;let t=e?.map((e=>({value:e,label:e})));return t.unshift({label:P("All","poptics"),value:""}),t},g=(e,t)=>{i((a=>({...a,[e]:t})))},b=(0,l.useRef)(!0);return(0,l.useEffect)((()=>{!0!==b.current?t(a):b.current=!1}),[JSON.stringify(a)]),(0,s.createElement)(m.A,{gap:"small",align:"center",justify:"center"},(0,s.createElement)(F.A,null),(0,s.createElement)(n.SelectInput,{loading:""===p,placeholder:P("Location","poptics"),options:d(p),size:"large",className:"pt-submission-filters-min-width",onChange:e=>{g("location",e)}}),(0,s.createElement)(n.SelectInput,{loading:""===o,options:d(o),placeholder:P("Device","poptics"),size:"large",className:"pt-submission-filters-min-width",onChange:e=>{g("device",e)}}),(0,s.createElement)(n.SelectInput,{loading:""===r,options:d(r),placeholder:P("Browser","poptics"),size:"large",className:"pt-submission-filters-min-width",onChange:e=>{g("browser",e)}}))};var j=a(42759);const{__:z}=wp.i18n,K=()=>{const{getAllSubmissionsByFiltering:e}=u();return(0,s.createElement)(m.A,{vertical:!0},(0,s.createElement)(m.A,{className:"pt-entries-title-bar-container",align:"center",justify:"space-between",wrap:!0},(0,s.createElement)(n.Title,{level:3,text:z("Entries","poptics")}),(0,s.createElement)("div",{className:"pt-entries-search-container"},(0,s.createElement)(j.A,{placeholder:z("Search Entries","poptics"),searchFunc:e}))),(0,s.createElement)(m.A,{className:"pt-entries-title-bar-container",align:"center",justify:"space-between",wrap:!0},(0,s.createElement)(O,null),(0,s.createElement)(M,null)),(0,s.createElement)(B,null))},{__:Q}=wp.i18n,R=($=()=>{const{submissionsList:e,searchQuery:t}=(0,l.useContext)(c),{paged:a,per_page:i}=t,{getAllSubmissionsByFiltering:r,getAllUserAgents:o}=u();return(0,l.useEffect)((()=>{r({paged:a,per_page:i}),o()}),[]),(0,s.createElement)(n.RowSkeleton,{rows:i,loading:!e},(0,s.createElement)(K,null))},e=>{const[t,a]=(0,l.useState)({submissionsList:null,total:null,showing:null,queryTotal:null,active:null,trash:null,searchQuery:{locations:"",devices:"",browsers:"",status:"",search_key:"",paged:o,per_page:p}});return(0,s.createElement)(c.Provider,{value:{...t,setSubmissionsData:a}},(0,s.createElement)($,{...e}))});var $}}]);